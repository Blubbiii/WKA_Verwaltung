# =====================================================
# WindparkManager - Environment Variables
# Copy this file to .env and fill in your values
# =====================================================

# ===========================================
# Application
# ===========================================
NODE_ENV=production
APP_DOMAIN=wpm.example.com
NEXTAUTH_URL=https://wpm.example.com
NEXTAUTH_SECRET=your-nextauth-secret-min-32-chars

# ===========================================
# Database (PostgreSQL)
# ===========================================
POSTGRES_USER=wpm
POSTGRES_PASSWORD=your-secure-database-password
POSTGRES_DB=windparkmanager
DATABASE_URL=postgresql://wpm:your-secure-database-password@db:5432/windparkmanager

# ===========================================
# Supabase (if using Supabase Cloud)
# ===========================================
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# ===========================================
# Redis
# ===========================================
REDIS_URL=redis://:your-redis-password@redis:6379
REDIS_PASSWORD=your-redis-password

# ===========================================
# Worker (Background Jobs)
# ===========================================
# Start mode: 'app' for Next.js server, 'worker' for background jobs
START_MODE=app
# Number of concurrent jobs per worker instance
WORKER_CONCURRENCY=5
# Number of worker replicas in production (docker-compose.prod.yml)
WORKER_REPLICAS=2

# ===========================================
# MinIO (S3-compatible Storage)
# ===========================================
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=your-minio-password

# ===========================================
# S3 Storage (used by the application)
# For local development with MinIO, use defaults
# For production with AWS S3, update accordingly
# ===========================================
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin
S3_BUCKET=wpm-documents
S3_REGION=us-east-1

# ===========================================
# Email (SMTP) - Fallback Configuration
# Used when tenant-specific settings are not configured
# ===========================================
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=your-smtp-user
SMTP_PASS=your-smtp-password
EMAIL_FROM_ADDRESS=noreply@example.com
EMAIL_FROM_NAME=WindparkManager

# Email Encryption Key (64 hex characters)
# Generate with: openssl rand -hex 32
# Used to encrypt sensitive email config stored in database
EMAIL_ENCRYPTION_KEY=your-64-character-hex-key-here

# ===========================================
# External APIs - Weather
# ===========================================
# OpenWeatherMap API Key (get one at https://openweathermap.org/api)
OPENWEATHERMAP_API_KEY=your-openweathermap-api-key
# Weather Cache TTL in seconds (default: 30 minutes)
WEATHER_CACHE_TTL=1800
# Weather sync interval in minutes (default: 30)
WEATHER_SYNC_INTERVAL=30
# Weather API rate limit (requests per minute, OpenWeatherMap free tier: 60)
WEATHER_RATE_LIMIT=60

# ===========================================
# SSL/TLS (Let's Encrypt)
# ===========================================
ACME_EMAIL=admin@example.com

# ===========================================
# Traefik Dashboard (optional)
# Generate with: htpasswd -nb admin password
# ===========================================
TRAEFIK_DASHBOARD_AUTH=admin:$apr1$xyz...

# ===========================================
# Logging
# ===========================================
# Log level: trace, debug, info, warn, error, fatal
LOG_LEVEL=debug

# ===========================================
# Error Tracking (Sentry)
# ===========================================
SENTRY_DSN=
NEXT_PUBLIC_SENTRY_DSN=
SENTRY_AUTH_TOKEN=
SENTRY_ORG=
SENTRY_PROJECT=

# ===========================================
# Performance Monitoring
# ===========================================
# Requests slower than this threshold (in ms) are logged as warnings
SLOW_REQUEST_THRESHOLD=2000

# ===========================================
# Database Backup Configuration
# ===========================================
# Retention: number of backups to keep per category
BACKUP_RETENTION_DAILY=7
BACKUP_RETENTION_WEEKLY=4
BACKUP_RETENTION_MONTHLY=3

# S3/MinIO backup storage (optional, in addition to local storage)
# Set BACKUP_S3_ENABLED=true to upload backups to S3 after creation
BACKUP_S3_ENABLED=false
BACKUP_S3_BUCKET=wpm-backups
BACKUP_S3_ENDPOINT=http://minio:9000
# S3 credentials default to MINIO_ROOT_USER/PASSWORD if not set
# BACKUP_S3_ACCESS_KEY=minioadmin
# BACKUP_S3_SECRET_KEY=your-minio-password

# Cron schedule (configured in docker-compose.prod.yml):
# Daily:   02:00 every day
# Weekly:  03:00 every Sunday
# Monthly: 04:00 first day of month
